{
id: "sequences_",

// See this file for all the documentation.
prototype: ['sequence_handler_'],

properties: {
	seqLibrary_: "{ string -> { string -> [commands] } } :: {
		'general': {
			'null': [],
			'cycle': [debug(cycle), debug(cycle)],
			'clear desc': [lp.AddDesc('', true)],
		},

		'test01.cfg': {
			'Check Hole': [
				lp.AddDesc(
				 ~You can't go any futher\!\n~ +
				 ~From the chasm, you hear a quiet voice...~,
				 true, true
				),

				lp.AddDial(
				 ~???: _W5_Do you wish to enter the catacombs?_W_~,
				 false, true
				),

				lp.CreateChoices({
				 'Yes': teleport('test02.cfg'),
				 'No' : lp.AddDial(~???: Coward...~, true)
				}),
			],
		}, // End of test01.cfg
		
		'test02.cfg': {
			'Gate button': [
				lp.AddDesc(
				 ~There\'s an oval-shaped button on the wall.~,
				 true, true
				),
	
				[	set(lp.seqIsBusy, true),
					lp.CreateChoices({
					 'Push it': [lp.StartSeq('Toggle gate'),
					 			 set(lp.seqIsBusy, false),
								 lp.AddDesc('', true)
								],
					}),
				],
			],

			'Toggle gate': [
				// Avoid possibility of null AND check if we've opened it
				if(get_object(level, 'Gate1') != null and
				   get_stored_event('Gate opened') != 1,
						[fire_event(gc, 'toggle_solidity'), store_event('Gate opened', 1)],
						lp.AddDesc(~Nothing happens. You already pressed it.~, true)
				)			
			] where gc = get_object_or_die(level, 'Gate1'),

		
			'Describe gate': [
				if(get_stored_event('Gate opened') != 1, [
						AddDesc(~There's a criss-cross of iron bars here.~,
								true),
					
						CreateChoices({
							'Push on it!': AddDesc(~It won't budge...~, true),
							'Pull it!': AddDesc(~It shifts slightly and makes a rattling sound.~, true)
						})
				])
			]
		}, // End test02.cfg
		
	} where lp = level.player",

} // End of properties

} // End of file
